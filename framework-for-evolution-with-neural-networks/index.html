<!doctype html>
<html lang="EN">
<head>
  <script id="usercentrics-cmp" src="https://app.usercentrics.eu/browser-ui/latest/loader.js" data-settings-id="DH1Rs7wCZAKJtQ" async></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset='UTF-8'>
  <meta name='keywords' content='python, machine learning'>
  <meta name='description' content='Educating programmers about interesting, 
    crucial topics. Articles are intended to break down tough subjects, while 
    being friendly to beginners'>
  <meta name='subject' content='Python / Machine Learning articles'>
  <meta name='copyright' content='pythonkitchen.com'>
  <meta name='language' content='EN'>
  <meta name='robots' content='index,follow'>
  <meta name='revised' content='Wednesday, August 30thth, 2023, 13:30 pm'>
  <meta name='abstract' content=''>
  <meta name='topic' content='python'>
  <meta name='summary' content=''>
  <meta name='Classification' content='Education'>
  <meta name='author' content='PythonKitchen, email@hotmail.com'>
  <meta name='designer' content=''>
  <meta name='reply-to' content='email@hotmail.com'>
  <meta name='owner' content=''>
  <meta name='url' content='https://www.pythonkitchen.com'>
  <meta name='identifier-URL' content='https://www.pythonkitchen.com'>
  <meta name='directory' content='submission'>
  
  
  <meta name='target' content='all'>
  <meta name='HandheldFriendly' content='True'>
  <meta name='MobileOptimized' content='320'>
  <meta name='date' content='2025-02-15 15:40:00'>
  <meta name='DC.title' content='Quality Python articles'>
  <meta name='ResourceLoaderDynamicStyles' content=''>
  <meta name='medium' content='blog'>
  <!-- <meta name='verify-v1' content='dV1r/ZJJdDEI++fKJ6iDEl6o+TMNtSu0kv18ONeqM0I='>
  <meta name='y_key' content='1e39c508e0d87750'> -->
  
  <meta http-equiv='Expires' content='0'>
  <meta http-equiv='Pragma' content='no-cache'>
  <meta http-equiv='Cache-Control' content='no-cache'>
  <meta http-equiv='imagetoolbar' content='no'>
  <meta http-equiv='x-dns-prefetch-control' content='off'>

  
  <meta name='og:type' content='blog'>
  <meta name='og:site_name' content='PythonKitchen'>
  <meta name='og:description' content='Educating programmers about interesting, 
  crucial topics. Articles are intended to break down tough subjects, while 
  being friendly to beginners'>

  <link rel="shortcut icon" href="/assets/logo.png" /> 
  
  <script src="https://cdn.tailwindcss.com"></script>
  <style>

  </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4895581427484601" crossorigin="anonymous"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161612035-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-161612035-3');
</script>

<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "ejj5ivpuup");
</script>

  <meta name='Biosim4: Framework For Evolution With Neural Networks' content=''>
  <meta name='category' content='machine learning'>
  <meta name='coverage' content='Worldwide'>
  <meta name='distribution' content='Global'>
  <meta name='rating' content='General'>
  <meta name='revisit-after' content='1 year'>
  <meta name='subtitle' content='Biosim4: Framework For Evolution With Neural Networks'>
  <meta name='pageKey' content='framework-for-evolution-with-neural-networks'>
  <meta name='og:title' content='Biosim4: Framework For Evolution With Neural Networks'>
  <meta name='og:url' content='https://www.pythonkitchen.com/framework-for-evolution-with-neural-networks'>

  <title>Biosim4: Framework For Evolution With Neural Networks</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>

<!-- and it's easy to individually load additional languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>

<link rel="stylesheet" href="/css/post.css"> 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/css/lightbox.min.css" integrity="sha512-ZKX+BvQihRJPA8CROKBhDNvoc2aDMOdAlcm7TUQY+35XYtrd3yh95QOOhsPDQY9QnKE0Wqag9y38OIgEvb88cA==" crossorigin="anonymous" referrerpolicy="no-referrer" />


</head>
<body class="bg-gray-50">

<nav class="bg-white border-gray-200 dark:bg-gray-900">
    <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
      <a href="/" class="flex items-center">
          <img src="/assets/logo.png" class="h-8 mr-3" alt="PythonKitchen Logo" 
            style="width: 50px !important; height: 50px !important;"/>
          <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">PythonKitchen</span>
      </a>
      <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
          <span class="sr-only">Open main menu</span>
          <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
          </svg>
      </button>
      <div class="hidden w-full md:block md:w-auto" id="navbar-default">
        <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
          <li>
            <a href="/" 
            class="block py-2 pl-3 pr-4 text-white bg-blue-700 rounded md:bg-transparent md:text-blue-700 md:p-0 dark:text-white md:dark:text-blue-500" aria-current="page">
            Home</a>
          </li>
          <li>
            <a href="https://docs.google.com/forms/d/e/1FAIpQLSdnP_IW4nK95hv-eBDIlxHb5E5DeOniFWBi9YmxlHZARLJDAQ/viewform" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">
              Write</a>
          </li>
          <li>
            <a href="https://forms.gle/gf1p1Aitw9M9m8Zy5" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">
              Contact</a>
          </li>
          <!-- <li>
            <a href="#" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">Pricing</a>
          </li>
          <li>
            <a href="#" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">Contact</a>
          </li> -->
        </ul>
      </div>
    </div>
  </nav>
  
  

<div class="p-8">

</div>

<div class="grid grid-cols-4">
    <div class="col-span-3">
        <div class="p-8 pl-12">
            <div class="ml-2">
                <div class=" bg-white rounded-lg shadow-lg" style="padding: 4vw !important;">
                    <p class="text-3xl" style="font-weight: 600;">Biosim4: Framework For Evolution With Neural Networks</p>
                    <br>
                    <div class="flex items-center gap-x-4 text-xs">
                        <time datetime="2022-10-12 12:19:03" class="text-gray-500">October 12, 2022</time>
                        
                        <a href="#" class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100">
                            machine learning
                        </a>
                        
                    </div>
                    
                        <div class="relative mt-8 flex items-center gap-x-4">
                            <img src="https://github.com/abdullium.png?size=40" alt="" class="h-10 w-10 rounded-full bg-gray-50">
                            <div class="text-sm leading-6">
                            <p class="font-semibold text-gray-900">
                                <a href='https://www.linkedin.com/in/md-abdul/'>
                                <span class="absolute inset-0"></span>
                                Abdul Khan
                                </a>
                            </p>
                            <p class="text-gray-600">Data scientist</p>
                            </div>
                        </div>
                    
                    <br>
                    <article>
                        <p><strong>Biosim4</strong> is a project in which there&rsquo;s a 2-dimensional world where creatures with neural brains live in it. They have genomes (complete genetic information) that they pass on from one generation to the next generation, And these creatures have neural network brains that govern their behaviour. This project aims to try setting up the conditions necessary for evolution to occur and then see what happens next. Would the creatures evolve their brains in response to their environment? This article will provide you with detailed information about the code structure, functionality and overall understanding of evolution connecting with neural networks. Note that we won&rsquo;t be seeing an actual simulation here. The best thing to do is to watch the video given above, This article is only for understanding the code structure of this program, But before we read the code, let&rsquo;s brush up on our basics on evolution first!</p>
<h2>Table of content</h2>
<ul>
<li>About Evolution</li>
<li>Data Structures Of Biosim4</li>
<li>Sensory inputs and action outputs</li>
<li>Fundamental value types</li>
<li>Pheromones</li>
</ul>
<p>Note: a code/function/class/container is referred as this: <code>code</code>, <code>function</code>, <code>class</code>, <code>container</code>
And Files are referred as links <a href="https://github.com/davidrmiller/biosim4/blob/main/Makefile">File</a> 
About Evolution</p>
<hr />
<p>Evloution can happen:</p>
<ul>
<li>without any external effort</li>
<li>without any planning</li>
<li>without any future oversight</li>
</ul>
<p>If the following conditions are satisfied:</p>
<ol>
<li><strong>Self-Replication -</strong> Any behaviour of an organism&rsquo;s system that yields the construction of a similar copy of its Biological cells, Given suitable environments. In our simulator, Each creature is just a little data structure. It contains a few bits of information like where it lives in the world, its genome and its neural network brain.</li>
<li>Genome - the genome is a complete set of genetic information of an organism. It provides all the information the organism requires to function, And DNA and RNA are specific chemical storage formats for storing that information. In nature, DNA is just a long strand of a protein molecule. A DNA strand in our simulator might look like this.</li>
</ol>
<blockquote>
<p><strong>&ldquo;</strong> CAGAAGATGATAAGC TCCGGCAAGCAATTAT GAACAACGCAAGGATC
 GGCGATATAAACAGAG <strong>&ldquo;</strong></p>
</blockquote>
<p>{Fact: In each one of your cells, there are approx. 3 billion of these DNA letters} This simulator(Biosim4) also uses strings of letters or characters to store each individual&rsquo;s genome. But its genomes are a lot shorter. It only uses a few dozen Letters or maybe a few hundred Letters at most.</p>
<ol>
<li>Inherited genome - Genome inherited by parents/replicator. You contain DNA that partly comes from one parent and part comes from the other parent, And that&rsquo;s what is done in the simulator, When a new child is born in our simulator, We copy the data structure, but we also copy some of the genomes from one parent and some of the genomes from the other parent which makes up a new genome for the child data structure.</li>
<li>Mutation - The inherited genome gets passed to the offspring and has to undergo occasional modifications/enhancements. Usually, when you inherit the genes from your parents, those genes are copied 100% accurately most of the time, But once in a while, you&rsquo;ll have a gene that you get that has one different letter, or a few letters are different, and that is called mutation In our simulator, there&rsquo;s a parameter that tells how often a mutation happens there&rsquo;s one chance in 1000 that any gene that gets inherited will have a single-bit error in its copy. That means the genome inherited by the child will have a 1 in 1000 chance of being modified/enhanced from the rest of 999, and this satisfies our condition for mutation.</li>
</ol>
<h2>A Complete Code Walkthrough of Biosim4</h2>
<h3>Data Structures Of Biosim4:</h3>
<p><strong>The World Structure</strong> - The creatures live in a simulation where there&rsquo;s a 2D arena. Class <code>Grid</code> (see <a href="https://github.com/davidrmiller/biosim4/blob/main/src/grid.h">&ldquo;grid.h&rdquo;</a> and <a href="https://github.com/davidrmiller/biosim4/blob/main/src/grid.cpp">&ldquo;grid.cpp&rdquo;</a>) contains a 2D array of 16-bit indexes, where each nonzero index refers to a specific individual in class <code>Peeps</code> (see below). Zero values in Grid indicate empty locations. Class Grid does not know anything else about the world; it only stores indexes to represent who lives where.
<em>Here&rsquo;s an image of our world !</em>
<img alt="Our World" src="https://raw.githubusercontent.com/Abdullium/NYPD/main/Screenshot%202022-10-07%20143229.png" />
<strong>The Population</strong> - The population of creatures is Stored in class Peeps (see <a href="https://github.com/davidrmiller/biosim4/blob/main/src/peeps.h">peeps.h</a> and <a href="https://github.com/davidrmiller/biosim4/blob/main/src/peeps.cpp">peeps.cpp</a>). Class <code>Peeps</code> contains each organism in the simulation, stored as instances of struct Indiv in a <code>std::vector</code> container. The indexes in class <code>Grid</code> are indexes into the vector of individuals in class Peeps. Class <code>Peeps</code> keep a container of struct Indiv but otherwise do not know anything about the internal workings of these organisms.<img alt="The population" src="https://raw.githubusercontent.com/Abdullium/NYPD/main/Screenshot%202022-10-07%20143941.png" />
<strong>The Individual</strong> - Each individual is represented by an instance of <code>struct Indiv</code> (see <a href="https://github.com/davidrmiller/biosim4/blob/main/src/indiv.h">indiv.h</a> and <a href="https://github.com/davidrmiller/biosim4/blob/main/src/indiv.cpp">indiv.cpp</a>). struct Indiv contains an individual&rsquo;s genome. Its corresponding neural net brain and a redundant copy of the individual&rsquo;s X and Y location in the 2D Grid. It also contains a few other parameters for the individual, such as its &ldquo;responsiveness&rdquo; level, oscillator period, age, and other personal parameters. struct Indiv knows how to convert an individual&rsquo;s genome into its neural net brain at the beginning of the simulation. It also knows how to print the genome and neural net brain in text format to stdout during a simulation. It also has a function <code>Indiv::getSensor()</code> that is called to compute the individual&rsquo;s input neurons for each simulator step. All the simulator code lives in the BS namespace called &ldquo;biosim4&rdquo;.
<img alt="The individual" src="https://raw.githubusercontent.com/Abdullium/NYPD/main/Screenshot%202022-10-07%20143852.png" />
<strong>The Configuration File:</strong></p>
<p>The configuration file, named <a href="https://github.com/davidrmiller/biosim4/blob/main/biosim4.ini">biosim4.ini</a> by default, contains all the tunable parameters for a simulation run. The biosim4 executable reads the configuration file at startup And then monitors it for changes during the simulation. Although it&rsquo;s not foolproof, Many of its parameters can be modified during the simulation run. Class <code>ParamManage</code>r (see <a href="https://github.com/davidrmiller/biosim4/blob/main/src/params.h">params.h</a> and <a href="https://github.com/davidrmiller/biosim4/blob/main/src/params.cpp">params.cpp</a>) manages the configuration parameters and makes them available to the simulator through a read-only pointer provided by <code>ParamManager::getParamRef()</code>. See the provided biosim4.ini for documentation for each parameter. Most parameters in the configuration file corresponding to members in struct Params (see params.h).</p>
<p><strong>The Program Output:</strong></p>
<p>Depending on the parameters in the configuration file. These are the following results that can be produced by biosim4:</p>
<ol>
<li>
<p>The simulator will append one line to logs/epoch.txt after the completion of each generation. Each line records the generation number, the number of individuals who survived the selection criterion, an estimate of the population&rsquo;s genetic diversity, average genome length, and the number of deaths due to the <a href="https://www.researchgate.net/figure/The-number-of-genes-killed-by-selection-in-the-course-of-evolution-during-which-mutation_fig3_220858827">&ldquo;Kill gene&rdquo;</a>. This file epoch.txt can be fed to tools/<a href="https://github.com/davidrmiller/biosim4/blob/main/tools/graphlog.gp">graphlog.gp</a> to produce a graphic plot.</p>
</li>
<li>
<p>The simulator will display a small number of sample genomes at regular intervals to stdout. Parameters in the configuration file specify the number and interval. The genomes are in hex format and Also in mnemonic that can be fed to tools
{Fact: In each one of your cells, there are approx. 3 billion of these DNA letters} 
This simulator(Biosim4) also uses strings of letters or characters to store each individual&rsquo;s genome. But its genomes are a lot shorter. It only uses a few dozen Letters or maybe a few hundred Letters at most. to produce a graphic network diagram.</p>
</li>
<li>
<p>Movies of the selected generations will be created in the images/ directory. Parameters in the configuration file specify the interval at which to make movies. Each movie records a single generation.</p>
</li>
<li>
<p>At intervals, a summary is printed to stdout showing the total number of neural connections throughout the population from each possible sensory input neuron and to each possible action output.</p>
</li>
</ol>
<p><strong>Main program loop</strong></p>
<p>The simulator starts with a call to the <code>simulator()</code> in <a href="https://github.com/davidrmiller/biosim4/blob/main/src/simulator.cpp">simulator.cpp</a>, After initializing the world, The simulator executes three nested loops:</p>
<ol>
<li>
<p>The outer Loop for each generation</p>
</li>
<li>
<p>Inner Loop for each simulator step within the generation</p>
</li>
<li>
<p>Innermost Loop for each individual of the population</p>
</li>
</ol>
<p>At the end of each simulator step, a call is made to <code>endOfSimStep()</code> in single-thread mode (see <a href="https://github.com/davidrmiller/biosim4/blob/main/src/endOfSimStep.cpp">endOfSimStep.cpp)</a> to create a video frame representing the locations of all the individuals at the end of the simulator step. The video frame is pushed onto a stack to be converted to a movie later. At the end of each generation, a call is made to <code>endOfGeneration()</code> in single-thread mode (see <a href="https://github.com/davidrmiller/biosim4/blob/main/src/endOfGeneration.cpp">endOfGeneration.cpp</a>) to create a video from the saved video frames. Also, a new graph might generate showing the progress of the simulation. See endOfGeneraton.cpp for more information.</p>
<h3>Sensory inputs and action outputs</h3>
<p>Every one of our creatures is born with a certain number of sensory inputs pre-installed alongside a collection of output action neurons. Initially, When an organism is born, its brain is not wired up well enough as much as its parents. It&rsquo;s the quality of the genome inherited from the parent which determines motor functionality, intelligence, and survival instincts (a.k.a wiring). Each sensory input and each action output is a neuron in the individual&rsquo;s neural net brain. The header file <a href="https://github.com/davidrmiller/biosim4/blob/main/src/sensors-actions.h">sensors-actions.h</a> contains <code>Enum Sensor</code> that enumerates all the possible sensory inputs and <code>Enum Action</code>. Enum action enumerates all the possible action outputs. In Enum Sensor, all the sensory inputs before the enumerant NUM_SENSES will be compiled into the executable, And all action outputs before NUM_ACTIONS will be compiled. By rearranging the enumerants in those enums, you can select a subset of all possible sensory and action neurons to be compiled into the simulator.</p>
<p>Here are all the sensory inputs:
<img alt="sensory inputs" src="https://raw.githubusercontent.com/Abdullium/NYPD/main/Screenshot%202022-10-07%20152614.png" /></p>
<p>Here are all the action outputs:
 <img alt="enter image description here" src="https://raw.githubusercontent.com/Abdullium/NYPD/main/Screenshot%202022-10-07%20152657.png" /></p>
<h3>Fundamental value types</h3>
<p>There are a few basic value types:</p>
<ul>
<li>
<p><code>Enum Compass</code> represents eight-way directions with enumerants N=0, NE, E, SW, S, SW, W, NW, and CENTER.</p>
</li>
<li>
<p><code>Struct Dir</code> is an abstract representation of the values of Enum Compass.</p>
</li>
<li>
<p><code>Struct Coord</code> is a signed 16-bit integer X, Y coordinate pair. It is used to represent a location in the 2D world or can Represent the difference between two locations.</p>
</li>
<li>
<p><code>Struct Polar</code> holds a signed 32-bit integer magnitude and a direction of type Dir.</p>
</li>
</ul>
<p>Various conversions and math are possible between these basic types. See <a href="https://github.com/davidrmiller/biosim4/blob/main/src/unitTestBasicTypes.cpp">unitTestBasicTypes.cpp</a></p>
<h3>Pheromones</h3>
<p>A simple system used to simulate pheromones emitted by individuals. Pheromones are called &ldquo;signals&rdquo; in our simulator(see <a href="https://github.com/davidrmiller/biosim4/blob/main/src/signals.h">signals.h</a> and <a href="https://github.com/davidrmiller/biosim4/blob/main/src/signals.cpp">signals.cpp</a>). <code>Struct Signals</code> holds a single layer that overlays the 2D world in class Grid. Each location can contain a volume of pheromones(there&rsquo;s only a single kind of pheromone supported at present). The pheromone volume at any grid location is stored as an unsigned 8-bit integer, where zero means no pheromone, and 255 is the maximum. Each time an individual emits a pheromone, it increases the pheromone values in a small neighbourhood around the individual up to the maximum of 255.</p>
<p><strong>I hope that by now you would have understood the code,
to see the actual simulation</strong> <a href="https://www.youtube.com/watch?v=N3tRFayqVtk&amp;list=WL&amp;index=23">click here</a>
* <a href="https://youtu.be/N3tRFayqVtk">Source - Youtube</a></p>

                        <script src="https://utteranc.es/client.js"
        repo="pythonkitchen/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
                    </article>
                
                  </div>
                
            </div>
        </div>
        
    </div>
    <div class="col-span-1">
        <div class="p-8 pl-12">
            <div class="ml-2">
                <div class=" bg-white rounded-lg shadow-lg" style="padding: 5px">
                    <article>
                        <a  target="_blank" href="https://leanpub.com/c/flask-masterclass">
                            <img id="side-img" src="/assets/flaskcoursefree.png" style="width: 100% !important">
                        </a>
                        Free Flask Course
                    </article>
                    </div>
                    
                    
            </div>
        </div>

        
    </div>
  </div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>hljs.highlightAll();</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.4/js/lightbox.min.js" integrity="sha512-Ixzuzfxv1EqafeQlTCufWfaC6ful6WFqIz4G+dWvK0beHw0NVJwvCKSgafpy5gwNqKmgUfIBraVwkKI+Cz0SEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script type="text/javascript">
    var img = jQuery("img");

img.each(function() {
   var element = jQuery(this);
   var a = jQuery("<a />", {href: element.attr("src"), "data-lightbox": "test"});

   element.wrap(a);
});

    $("#side-img").parent().removeAttr( "data-lightbox" ).attr("href","https://leanpub.com/c/flask-masterclass").attr("target","_blank");
</script>

</body>
</html>