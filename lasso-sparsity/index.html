<!doctype html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    a {
	word-wrap: break-word !important;
}
  </style>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1234567890123456" crossorigin="anonymous"></script>
  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161612035-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-161612035-3');
</script>

<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "ejj5ivpuup");
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>

<!-- and it's easy to individually load additional languages -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>

<link rel="stylesheet" href="/css/post.css"> 

</head>
<body class="bg-gray-50">

<nav class="bg-white border-gray-200 dark:bg-gray-900">
    <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
      <a href="/" class="flex items-center">
          <img src="https://www.pythonkitchen.com/wp-content/uploads/2022/11/cropped-p3-50x50.png" class="h-8 mr-3" alt="PythonKitchen Logo" />
          <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">PythonKitchen</span>
      </a>
      <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
          <span class="sr-only">Open main menu</span>
          <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
          </svg>
      </button>
      <div class="hidden w-full md:block md:w-auto" id="navbar-default">
        <ul class="font-medium flex flex-col p-4 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
          <li>
            <a href="/" 
            class="block py-2 pl-3 pr-4 text-white bg-blue-700 rounded md:bg-transparent md:text-blue-700 md:p-0 dark:text-white md:dark:text-blue-500" aria-current="page">
            Home</a>
          </li>
          <li>
            <a href="https://github.com/pythonkitchen/pythonkitchen/tree/source/data/posts" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">
              Write</a>
          </li>
          <li>
            <a href="https://forms.gle/gf1p1Aitw9M9m8Zy5" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">
              Contact</a>
          </li>
          <!-- <li>
            <a href="#" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">Pricing</a>
          </li>
          <li>
            <a href="#" class="block py-2 pl-3 pr-4 text-gray-900 rounded hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 dark:text-white md:dark:hover:text-blue-500 dark:hover:bg-gray-700 dark:hover:text-white md:dark:hover:bg-transparent">Contact</a>
          </li> -->
        </ul>
      </div>
    </div>
  </nav>
  
  

<div class="p-8">

</div>

<div class="flex flex-row space-x-2">
    <div class="basis-3/4">
        <div class="p-8 pl-12">
            <div class="ml-2">
                <div class=" p-12 bg-white rounded-lg shadow-lg">
                    <p class="text-3xl" style="font-weight: 600;">Why Does Lasso (L1) Regression Create Sparsity?</p>
                    <br>
                    <div class="flex items-center gap-x-4 text-xs">
                        <time datetime="2022-11-17 03:14:41" class="text-gray-500">November 17, 2022</time>
                        
                        <a href="#" class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100">
                            machine learning
                        </a>
                        
                    </div>
                    
                        <div class="relative mt-8 flex items-center gap-x-4">
                            <img src="https://github.com/ParthShukla211.png?size=200" alt="" class="h-10 w-10 rounded-full bg-gray-50">
                            <div class="text-sm leading-6">
                            <p class="font-semibold text-gray-900">
                                <a href="#">
                                <span class="absolute inset-0"></span>
                                Parth Shukla
                                </a>
                            </p>
                            <p class="text-gray-600">Ml wizard</p>
                            </div>
                        </div>
                    
                    <br>
                    <article>
                        <p>The Lasso regression is a <a href="https://en.wikipedia.org/wiki/Regularization_(mathematics)" title="regularization">regularization</a> technique and a type of regression that is well-suited for models showing high levels of multicollinearity. It is also known as the L1 regularization technique. This technique is often used when there is a high number of features present in the dataset, as this technique can automatically perform feature selection. [<a href="https://machinelearningmastery.com/lasso-regression-with-python/" title="Read More">Read More</a>]</p>
<p>The full form of the word “LASSO” means Least Absolute Shrinkage and Selection Operator.</p>
<p>Regularization is an important concept used to avoid <a href="https://en.wikipedia.org/wiki/Overfitting" title="over-fitting">over-fitting</a> the data, especially where the trained and test data vary. This technique is implemented by adding a penalty term to the best fir line derived from the model trained on training data. By doing this, we can achieve lesser variance in the test data.</p>
<p>[caption id=&rdquo;attachment\_62245&rdquo; align=&rdquo;alignnone&rdquo; width=&rdquo;300&rdquo;]<img alt="" src="https://www.pythonkitchen.com/wp-content/uploads/2022/10/pk11-300x65.png" />
<a href="https://www.google.com/search?q=l1+regularization+formula&amp;tbm=isch&amp;ved=2ahUKEwii_Zntn-b6AhU1yKACHVRhDRwQ2-cCegQIABAA&amp;oq=l1+regularization+formula&amp;gs_lcp=CgNpbWcQAzIFCAAQgAQ6BAgjECc6BwgAEIAEEBhQnQhY7xJgzRNoAHAAeACAAY0DiAG8CJIBBzAuNC4wLjGYAQCgAQGqAQtnd3Mtd2l6LWltZ8ABAQ&amp;sclient=img&amp;ei=KcJMY-LEAbWQg8UP1MK14AE&amp;bih=579&amp;biw=1204&amp;rlz=1C1CHBD_enIN933IN933&amp;hl=en-GB#imgrc=iQSJGTgfx9f-1M" title="Image Source">Image Source</a></p>
<p>In the above image, we can see that the loss function is a sum of 2 terms, the error term and the penalty term L1. The error term can be any loss function for the regression problem like mean absolute error, mean squared error, r2 score, etc. The penalty term is an absolute value of weight Wi and the Lambda is a coefficient multiplied by the penalty term L1.</p>
<h2>TABLE OF CONTENT</h2>
<ul>
<li>The Reason Behind Spasity</li>
<li>Case 1: Ridge Regression</li>
<li>Case 2: Lasso Regression</li>
<li>3 Different Conditions For Values of &ldquo;m&rdquo; in Lasso Regression</li>
<li>Conclusion</li>
<li>References</li>
</ul>
<h2>The Reason Behind Sparsity</h2>
<p>In the case of Simple Linear Regression, the formula for the best-fit line was</p>
<pre><code class="language-python">y = mx + b

</code></pre>
<p>where m is the slope of the best fit line and the term b is the y-axis intercept. So from the equation of y, we can derive that:</p>
<pre><code class="language-python">b = y^ - mx^

</code></pre>
<p>where, y^ = mean of y values</p>
<p>x^ = mean of x values</p>
<p>from the statistical solutions, we can derive the formula for m which stand to be</p>
<p><img alt="" src="https://www.pythonkitchen.com/wp-content/uploads/2022/10/pk22-300x93.png" /></p>
<h3>Case 1: Ridge Regression</h3>
<p>In the case of Ridge or L2 regression, the formula of the loss function will be the same as the normal loss function but with the additional penalty term L2.</p>
<p>[caption id=&rdquo;attachment\_62247&rdquo; align=&rdquo;alignnone&rdquo; width=&rdquo;300&rdquo;]<img alt="" src="https://www.pythonkitchen.com/wp-content/uploads/2022/10/pk33-300x100.png" />
<a href="https://www.google.com/search?q=ridge+regression+formula&amp;rlz=1C1CHBD_enIN933IN933&amp;sxsrf=ALiCzsaOLnx_muyXNCCs2qTAtVg6ZfFQ6w:1665976855035&amp;source=lnms&amp;tbm=isch&amp;sa=X&amp;ved=2ahUKEwjAxpe1p-b6AhUWSWwGHeKHA_0Q_AUoAXoECAMQAw&amp;biw=1220&amp;bih=579&amp;dpr=1.12#imgrc=PkoL44AuplYS0M&amp;imgdii=TAJZGelDAz7-ZM" title="Image Source">Image Source</a></p>
<p>Where SSE = Squared Sum Error</p>
<p>If we modify this equation and try to get the formula for the slope m using statistical methods the formula will be the same as simple linear regression slope formula with an additional term lambda in the denominator.</p>
<p><img alt="" src="https://www.pythonkitchen.com/wp-content/uploads/2022/10/pk44-300x96.png" /></p>
<p>Now here in the case of ridge regression, to make the value of slope m to be zero, the term in the numerator should be zero, so here no matter how big or small the value of lambda is, it will not affect the value of m to be zero. So the value of slope m will always reach near values of zero but not the exact zero value.</p>
<h3>Case 2: Lasso Regression</h3>
<p>In the case of Lasso or L1 regression, the formula for the slope m will be different for 3 different values of m, which is for</p>
<ol>
<li><code>m</code> greater than zero.</li>
<li><code>m</code> less than zero.</li>
<li><code>m</code> equal to zero.</li>
</ol>
<h5>1. For <code>m</code> &gt; 0:</h5>
<p>when the value of m will be greater than zero it means that the term in the numerator will also be greater than zero. so now if we increase the values of lambda to some extent simply the value of the numerator in the equation will decrease, now after increasing the values of lambda, when the values of lambda will be equal to the other term in the numerator the difference will be zero and the values of m will be zero, but as we discussed for the zero value of m we have a different equation to follow. so the values will reach zero but they will not be negative as after reaching to zero value of m we have to follow another equation.</p>
<p><img alt="" src="https://www.pythonkitchen.com/wp-content/uploads/2022/10/pk5-300x92.png" /></p>
<h5>2. For <code>m</code> &lt; 0:</h5>
<p>In the case where the values of m will be less than zero, we have different equations to follow. same as the above case if we start increasing the value of lambda which is added in the numerator term, and if the other term in the numerator is negative then to some value of lambda the sum of these two terms will be negative, but after increasing the value of lambda the numerator term will start increasing and reached to zero, so it will reach to zero value but after reaching zero value this same equation will not be followed and then there will not be any reading after zero.</p>
<p><img alt="" src="https://www.pythonkitchen.com/wp-content/uploads/2022/10/pk7-300x97.png" /></p>
<h5>3. For <code>m</code> = 0:</h5>
<p>In the case of m equals zero we have the same equation as simple linear regression slope formula. which will be followed if the value of m reached zero.</p>
<p><img alt="" src="https://www.pythonkitchen.com/wp-content/uploads/2022/10/pk8-300x93.png" /></p>
<p>Let&rsquo;s try to understand the same thing with the help of an example dataset. In both cases, we can apply ridge and lasso regression and analyze the values with the description of the features.</p>
<p>In the case of ridge regression, different features can have high negative or positive values but as the value of alpha or lambda increases the values tend to be reach near zero but do not attain the exact zero values.</p>
<p><img alt="" src="https://www.pythonkitchen.com/wp-content/uploads/2022/11/lasso-s-3-300x200.png" />
<a href="https://www.analyticsvidhya.com/wp-content/uploads/2016/01/8.-lasso-table_modified.png" title="Image Source">Image Source</a></p>
<p>If we try to apply the lasso regression to the same dataset and try to plot the table for that, the values of different features are having high positive or negative values, but as the value of alpha or lambda increases the values start reaching the exact zero value but not more or less than that as after reaching zero, it will follow another equation for the suitable situation of m being positive or negative.</p>
<h2>Conclusion</h2>
<p>In this article, we first understood the basic concept of ridge and lasso regression and their respective formulas for loss and slope functions. The reasons why lasso regression creates sparsity are discussed institutionally with mathematical formulas. Understanding these key concepts will help one to understand the reason and the core math behind the ridge and lasso regression and their behaviour to create sparsity or not.</p>
<p>Some <strong>Key Insights</strong> from this article are:</p>
<ol>
<li>The Ridge and Lasso regressions are the regularization techniques used for many purposes. (e.g avoid over-fitting, feature selection, etc.)</li>
<li>The loss functions for ridge and lasso regression are attained by adding the penalty term L2 and L1 respectively to the normal loss function.</li>
<li>The ridge regression does not crease sparsity as the lambda term in the denominator will not affect the value of the term in the numerator and hence the value of slope m.</li>
<li>Lasso regression creates sparsity in the dataset as there is a lambda term added or subtracted for different values of slope m and when the value of m reached zero but does not cross zero value.</li>
</ol>
<h2>References</h2>
<ul>
<li>[1] https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html</li>
<li>[2] https://jamesmccaffrey.wordpress.com/2022/10/21/lasso-regression-from-scratch-using-python/</li>
<li>[3] https://hands-on.cloud/implementation-of-ridge-and-lasso-regression-using-python/</li>
<li>[4] https://www.delftstack.com/howto/python/lasso-regression-in-python/</li>
<li>[5] https://you.com/search?q=lasso%20regression%20implementation%20python</li>
</ul>

                        <script src="https://utteranc.es/client.js"
        repo="pythonkitchen/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
                    </article>
                
                  </div>
                
            </div>
        </div>
        
    </div>
    <div class="basis-1/4"></div>
  </div>




<script>hljs.highlightAll();</script>




</body>
</html>